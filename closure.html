<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>클로저</title>
  </head>
  <body>
    <script>
      // 함수는 블록으로 둘러싸여 있고 하나의 스코프를 형성한다.
      // 자바스크립트에서의 스코프는 특정 변수에 대한 접근 가능 여부를 결정하는 환경(context)이다.
      
      // 스코프는 두 가지로 나뉘어지는데, 전역(global)과 지역(local).
      // 전역은 어느 블록에도 속하지 않은 위치에서 선언된 것이며
      // 지역은 블록 내에 선언된 것을 말한다.

      // 함수 내 지역변수는 함수 외에서는 접근할 수 없으며
      // 함수가 끝나면 더이상 사용할 수 없다.

      // 그러나, 자바스크립트는 리턴된 함수를 통해
      // 함수 내 선언된 지역변수들을 접근하게 할 수 있음으로써
      // 클로저(closure)를 형성할 수 있다.
      // 클로저는 함수의 실행이 끝난 뒤에도 함수 내 지역변수들을 접근할 수 있도록 만든 함수를 말한다.
      // 즉, 클로저는 접근 불가능한 영역에 통로를 만들어주는 수단이 될 수 있다.

      // 그렇다면 사용하는 목적은?
      // 데이터 프라이버시 / 모듈 패턴에서 private 메소드를 구현하기 위해 쓰임.

      // 예시: 함수 내 변수 업데이트
      function berigooCounter () {
        let count = 0
        function incBerigoo () {
          count++
          return count
        }
        return incBerigoo
      }

      const koishie = berigooCounter()
      console.log(koishie)
      console.log(`koishie is ${koishie()} time berigoo!`) // 1
      console.log(`koishie is ${koishie()} time berigoo!`) // 2
      console.log(`koishie is ${koishie()} time berigoo!`) // 3
      console.log(`koishie is ${koishie()} time berigoo!`) // 4
      console.log(`koishie is ${koishie()} time berigoo!`) // 5
      console.log(`koishie is ${koishie()} time berigoo!`) // 6

      // 예시: currying
      function curry(fn, a) {
        return function (b) {
          return fn(a, b)
        }
      }

      const mult3 = curry((x, y) => {return x * y}, 3)
      console.log(mult3(9))
    </script>
  </body>
</html>